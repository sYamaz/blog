# Copilot Instructions

## Language

このプロジェクトは日本人メンバーのみが参画しているため、すべてのコミュニケーション（コメント、ドキュメント、提案、レビューなど）は**日本語**で行ってください。

## Project Overview

This is an [Eleventy](https://www.11ty.dev) (11ty) static site generator blog written in Japanese, using Nunjucks templates and Markdown for content. The blog focuses on technical topics and personal insights.

## Architecture & Key Components

- **`.eleventy.js`**: Core SSG configuration - defines collections, passthrough copies, and custom filters. Manages the "sortedpost" collection sorted by date (newest first). Input directory configured to `src/`.
- **`src/_includes/`**: Nunjucks layout templates. `layout.njk` is the base HTML structure; `post.njk` extends it for individual post pages.
- **`src/posts/`**: Markdown content files. Each post is in its own folder (e.g., `src/posts/post-slug/index.md`) with a separate `img/` subfolder for images.
- **`src/styles/`**: CSS files. `reset.css` for normalization; `custom.css` for styling. Passthrough copied to output.
- **`src/index.njk`**: Homepage template that iterates over `collections.sortedpost` to display post previews.

## Content & Frontmatter

All markdown posts require YAML frontmatter:
```yaml
---
title: Post title
date: YYYY-MM-DD
tags: post
layout: post
---
```

**Critical**: `tags: post` is required for posts to appear in the collection. The `layout: post` directive uses `post.njk` template.

## Markdown Conventions

- **Heading levels**: Only use `##` (h2) and `###` (h3). `#` is reserved for the post title auto-generated by the template.
 - **Heading levels**: Only use `##` (h2) and `###` (h3). `#` is reserved for the post title auto-generated by the template. For posts, prefer writing headings with `##` rather than `#` so the deployed page layout and TOC remain consistent (`#` is handled by the template).
- **Images**: Store in `src/posts/{post-slug}/img/` and reference locally: `![alt text](./img/filename.png)`
- **Text lint rules** (`.textlintrc`): Japanese spacing preset enabled. Kanji continuous length max 6 chars (exception: "応用情報技術者試験").

## Development Workflows

- **Local development**: `npm run dev` - starts Eleventy in watch mode with live reload on `http://localhost:8080`
- **Production build**: `npm run build` - generates static site in `_site/` directory
- **Text linting**: `npm run textlint` - validates Japanese text rules in `posts/**/*.md` using textlint

## Custom Filters & Collections

- **`excerpt(content, length)`**: Strips HTML tags and truncates to N characters (default 140). Used in post list preview.
- **`date(dateObj)`**: Formats dates as `YYYY-MM-DD`.
- **`sortedpost` collection**: All markdown files with `tags: post`, sorted descending by date.

## Output Structure

Eleventy generates files in `_site/` (configured in `.eleventy.js`). The source directory is `src/`, so:
- `src/posts/post-slug/index.md` → `_site/posts/post-slug/index.html`
- Images in `src/posts/post-slug/img/` → `_site/posts/post-slug/img/`

## Dependencies

- `@11ty/eleventy@^3.1.2` - SSG core
- `textlint@^15.5.0` - Japanese text linting
- Textlint plugins: Japanese spacing and technical writing presets

## Common Tasks

**Adding a new post**: Create `src/posts/{slug}/index.md` with proper frontmatter, `tags: post`, and `layout: post`.

**Modifying templates**: Edit `.njk` files in `src/_includes/` or `src/index.njk`. Eleventy hot-reloads on save in dev mode.

**Image placement**: Store images alongside content in `src/posts/{slug}/img/`. They're auto-passthrough-copied to output.

**Updating styles**: Modify `src/styles/custom.css`. Changes apply to all pages via `layout.njk`.

## Content Review Guidelines

When reviewing markdown files in `posts/`, use the following specialized agents for comprehensive feedback:

- [**Content Scope & Intent Review**](.github/agents/content-scope-review.md) - Verify content remains focused on personal experiences, without attacks on others, with constructive tone
- [**Privacy & Personal Information Review**](.github/agents/privacy-review.md) - Ensure no personal information leaks of self or others
- [**Company Confidentiality & Reputation Review**](.github/agents/compliance-review.md) - Confirm no disclosure of company secrets or reputation-damaging content

Each agent provides specific criteria, examples, and checklists for high-quality, independent review of each aspect.
